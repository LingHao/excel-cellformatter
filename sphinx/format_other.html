

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Excelの書式のその他の情報 &mdash; Excel-CellFormatter 0.2 ドキュメント</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="Excel-CellFormatter 0.2 ドキュメント" href="index.html" />
    <link rel="next" title="5. リリースノート" href="release.html" />
    <link rel="prev" title="3. Excelの書式の基本について" href="format_basic.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="release.html" title="5. リリースノート"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="format_basic.html" title="3. Excelの書式の基本について"
             accesskey="P">前へ</a> |</li>
        <li><a href="index.html">Excel-CellFormatter 0.2 ドキュメント</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><div id="toc" class="sidebarRow">
<h3><a href="../index.html">プロジェクト情報</a></h3>
<ul>
	<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">Javadoc</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../project-info.html">プロジェクト情報</a></li>
</ul>

<h3><a href="index.html">目次</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="howtouse.html">1. 基本的な使い方</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id2">1.1. ダウンロード</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#apaceh-poi">1.2. Apaceh POIの場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#jexcelapi">1.3. JExcelAPIの場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="customize.html">2. カスタマイズ方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="customize.html#id2">2.1. キャッシュの制御</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="format_basic.html">3. Excelの書式の基本について</a><ul>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id1">3.1. 参考リンク</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id2">3.2. 表示形式の構造</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id6">3.3. 共通の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id7">3.4. 数値用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id12">3.5. 日時用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id16">3.6. 文字列用の書式記号</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id17">3.7. 条件式について</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_basic.html#id22">3.8. 他のオフィススイートの書式記号</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">4. Excelの書式のその他の情報</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">4.1. ファイル内部の日付の基準日の設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">4.2. ビルトインフォーマット（組み込み書式）について</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id-lcid">4.3. ロケールID(LCID)の一覧</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">4.4. 漢数字／大字変換のロジック</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">5. リリースノート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2015-04-04">5.1. ver.0.2 - 2015-04-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-1-2015-03-22">5.2. ver.0.1 - 2015-03-22</a></li>
</ul>
</li>
</ul>


</div>
  <h4>前のトピックへ</h4>
  <p class="topless"><a href="format_basic.html"
                        title="前の章へ">3. Excelの書式の基本について</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="release.html"
                        title="次の章へ">5. リリースノート</a></p>
  <h3>このページ</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/format_other.txt"
           rel="nofollow">ソースコードを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="excel">
<h1>4. Excelの書式のその他の情報<a class="headerlink" href="#excel" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="id1">
<h2>4.1. ファイル内部の日付の基準日の設定<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelは、ファイル内部では数値型として値を保持しており、値が0の場合は基準日として、通常は <strong>「1900年1月0日（1899年12月31日）」</strong> を表します。</p>
<p>この基準日は、設定によって変更することができ、ファイルごとに設定を持ちます。</p>
<ul class="simple">
<li><a class="reference external" href="https://support.microsoft.com/ja-jp/kb/180162/ja">Miscrosoftのサポートページ</a></li>
</ul>
<div class="section" id="excel1904">
<h3>4.1.1. Excelの1904年始まりの設定変更方法<a class="headerlink" href="#excel1904" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Excelのバージョンによって設定方法は変わります。</p>
<ul class="simple">
<li>Excel2000～2003の場合、メニュー「ツール」-「オプション」から表示されるダイアログ中のタブ「計算方法」から設定できます。</li>
<li>Excel2007の場合、Officeボタンの「オプション」から表示されるダイアログ中のペイン「詳細設定」から設定できます。</li>
<li>Excel2010の場合、メニュー「ファイル」の「オプション」から表示されるダイアログ中のペイン「詳細設定」から設定できます。</li>
<li>LibreOfficeの場合、メニュー「ツール」-「オプション」から表示されるダイアログ中のペイン「LibreOffice Calc」-「計算式」から設定できます。</li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_2002.png"><img alt="_images/excel_settings_date1904_2002.png" src="_images/excel_settings_date1904_2002.png" style="width: 460.5px; height: 286.0px;" /></a>
<p class="caption">Excel2002(XP)の場合の1904年始まりの設定</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_2010.png"><img alt="_images/excel_settings_date1904_2010.png" src="_images/excel_settings_date1904_2010.png" style="width: 428.0px; height: 182.0px;" /></a>
<p class="caption">Excel2010の場合の1904年始まりの設定</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/excel_settings_date1904_libre.png"><img alt="_images/excel_settings_date1904_libre.png" src="_images/excel_settings_date1904_libre.png" style="width: 565.0px; height: 233.0px;" /></a>
<p class="caption">LibreOfficeの場合の1904年始まりの設定</p>
</div>
</div>
<div class="section" id="id2">
<h3>4.1.2. ライブラリによる1904年始まりの判定方法<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="apache-poi1904">
<h4>4.1.2.1. Apache POIにおける1904年始まりの判定方法<a class="headerlink" href="#apache-poi1904" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Apache POIの場合、ファイルのフォーマットによって取得方法が変わります。</p>
<ul class="simple">
<li>公開されていないメソッドなのでリフレクションを使用して取得します。</li>
<li>本ライブラリでは、 <em>POICell#isDateStart1904()</em> 中のメソッドで実装されています。</li>
<li>1904年始まりかどうかの設定はファイル単位に持つため、Workbookを取得して判定を行います。</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">final</span> <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getSheet</span><span class="o">().</span><span class="na">getWorkbook</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">HSSFWorkbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 拡張子がxlsの場合</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">HSSFWorkbook</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">&quot;getWorkbook&quot;</span><span class="o">);</span>
        <span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="n">InternalWorkbook</span> <span class="n">iw</span> <span class="o">=</span> <span class="o">(</span><span class="n">InternalWorkbook</span><span class="o">)</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">iw</span><span class="o">.</span><span class="na">isUsing1904DateWindowing</span><span class="o">();</span>

    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access method HSSFWorkbook.getWorkbook.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IllegalAccessException</span> <span class="o">|</span> <span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">InvocationTargetException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke method HSSFWorkbook.getWorkbook.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">XSSFWorkbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 拡張子がxlsxの場合</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">XSSFWorkbook</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">&quot;isDate1904&quot;</span><span class="o">);</span>
        <span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="o">(</span><span class="kt">boolean</span><span class="o">)</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access method XSSFWorkbook.isDate1904.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IllegalAccessException</span> <span class="o">|</span> <span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">InvocationTargetException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke method XSSFWorkbook.isDate1904.&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="jexcelapi1904">
<h4>4.1.2.2. JExcelAPIにおける1904年始まりの判定方法<a class="headerlink" href="#jexcelapi1904" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>JExcel APIの場合も同様にWorkbookから取得しますが、セルクラスから上位のSheetクラスなどを取得できないため不便です。</p>
<ul class="simple">
<li>公開されていないメソッドなのでリフレクションを使用して取得します。</li>
<li>本ライブラリでは、 <em>JXLUtils#isDateStart1904(...)</em> 中のメソッドで実装されています。</li>
<li>1904年始まりかどうかの設定はシートにも引き継がれるため、Sheet、Wookbookのどちらからも判定できます。</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span class="c1">// Workbookを元に判定を行う場合</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isDateStart1904</span><span class="o">(</span><span class="kd">final</span> <span class="n">Workbook</span> <span class="n">workbook</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArgUtils</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">workbook</span><span class="o">,</span> <span class="s">&quot;workbook&quot;</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span><span class="n">workbook</span> <span class="k">instanceof</span> <span class="n">WorkbookParser</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">WorkbookParser</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&quot;nineteenFour&quot;</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">workbook</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access field WrokbookParser#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke field WrokbookParser#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// Sheetを元に判定を行う場合</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isDateStart1904</span><span class="o">(</span><span class="kd">final</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArgUtils</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="s">&quot;sheet&quot;</span><span class="o">);</span>

    <span class="k">if</span><span class="o">(</span><span class="n">sheet</span> <span class="k">instanceof</span> <span class="n">SheetImpl</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">SheetImpl</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&quot;nineteenFour&quot;</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">boolean</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">sheet</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="o">|</span> <span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail access field SheetImpl#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalArgumentException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">&quot;fail invoke field SheetImpl#nineteenFour&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>4.2. ビルトインフォーマット（組み込み書式）について<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelの書式は、ファイル内部では <em>インデックス番号</em> に対して、 <em>書式のパターン</em> が割り振られています。</p>
<p>その中で、インデックス番号が 0～49は予め固定のフォーマットを持ち、ビルトインフォーマット（組み込み書式）と呼ばれます。</p>
<ul class="simple">
<li>Excelのバージョンによっては、インデックス番号だけ持ち、書式を持たない場合があります。</li>
<li>50番以降は、ユーザ定義用書式として、ファイルによって異なります。</li>
<li>ただし、50～59番第は、Excelの言語環境によって予約された番号で、インデックス番号だけ持ち、書式をを持たない場合があります。</li>
<li>ビルインフォーマットは、JExcelAPIの場合とApaceh POIでは一部異なっています。</li>
<li>JExcelAPIの場合、明らかに間違った書式で定義されています。<ul>
<li>通貨記号を含む書式は、環境によって変わる可能性があります。</li>
</ul>
</li>
</ul>
<p>本ライブラリでは、OSの言語によって変わるような書式や間違っている書式は、予め <em>FormatterResolver#registerDefaultFormat()</em> メソッド内で登録し、正しい書式で取得できるようにしています。</p>
<table border="1" class="docutils">
<caption>ビルドインフォーマットの一覧</caption>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="25%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">16進</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">index</div>
<div class="line">10進</div>
</div>
</th>
<th class="head">JExcelAPI</th>
<th class="head">Apache POI</th>
<th class="head">Excel</th>
<th class="head">備考</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">General</span></tt></td>
<td><tt class="docutils literal"><span class="pre">標準/G</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
<td><tt class="docutils literal"><span class="pre">0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>2</td>
<td>2</td>
<td><tt class="docutils literal"><span class="pre">0.00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>3</td>
<td><tt class="docutils literal"><span class="pre">#,##0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>4</td>
<td>4</td>
<td><tt class="docutils literal"><span class="pre">0.00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>5</td>
<td><tt class="docutils literal"><span class="pre">($#,##0_);($#,##0)</span></tt></td>
<td>`` $#,##0_);($#,##0)``</td>
<td><tt class="docutils literal"><span class="pre">\#,##0;\-#,##0</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分で、符号がなく間違っている。</div>
<div class="line">さらに、通貨記号が異なる。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>6</td>
<td>6</td>
<td><tt class="docutils literal"><span class="pre">($#,##0_);[Red]($#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">$#,##0_);[Red]($#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\#,##0;[Red]\-#,##0</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分で、符号がなく間違っている。</div>
<div class="line">さらに、通貨記号が異なる。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>7</td>
<td><tt class="docutils literal"><span class="pre">($#,##0_);[Red]($#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">$#,##0.00);($#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">¥#,##0.00;¥-#,##0.00</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分で、符号がなく間違っている。</div>
<div class="line">さらに、通貨記号が異なる。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>8</td>
<td>8</td>
<td><tt class="docutils literal"><span class="pre">($#,##0.00_);[Red]($#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">$#,##0.00_);[Red]($#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\#,##0.00;[Red]\-#,##0.00</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分で、符号がなく間違っている。</div>
<div class="line">さらに、通貨記号が異なる。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>9</td>
<td>9</td>
<td><tt class="docutils literal"><span class="pre">0%</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0%</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0%</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>a</td>
<td>10</td>
<td><tt class="docutils literal"><span class="pre">0.00%</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00%</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00%</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>b</td>
<td>11</td>
<td><tt class="docutils literal"><span class="pre">0.00E+00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00E+00</span></tt></td>
<td><tt class="docutils literal"><span class="pre">0.00E+00</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>c</td>
<td>12</td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">?/?</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">?/?</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">?/?</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>d</td>
<td>13</td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">??/??</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">??/??</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#</span> <span class="pre">??/??</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>e</td>
<td>14</td>
<td><tt class="docutils literal"><span class="pre">dd/mm/yyyy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">m/d/yy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">m/d/yy</span></tt></td>
<td>JexcelAPIの場合、間違っている。</td>
</tr>
<tr class="row-odd"><td>f</td>
<td>15</td>
<td><tt class="docutils literal"><span class="pre">d-mmm-yy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">d-mmm-yy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">d-mmm-yy</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>10</td>
<td>16</td>
<td><tt class="docutils literal"><span class="pre">d-mmm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">d-mmm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">d-mmm</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>17</td>
<td><tt class="docutils literal"><span class="pre">mmm-yy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mmm-yy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mmm-yy</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>12</td>
<td>18</td>
<td><tt class="docutils literal"><span class="pre">h:mm</span> <span class="pre">AM/PM</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm</span> <span class="pre">AM/PM</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm</span> <span class="pre">AM/PM</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>19</td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span> <span class="pre">AM/PM</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span> <span class="pre">AM/PM</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span> <span class="pre">AM/PM</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>14</td>
<td>20</td>
<td><tt class="docutils literal"><span class="pre">h:mm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>21</td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">h:mm:ss</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>16</td>
<td>22</td>
<td><tt class="docutils literal"><span class="pre">m/d/yy</span> <span class="pre">h:mm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">m/d/yy</span> <span class="pre">h:mm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">m/d/yy</span> <span class="pre">h:mm</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>25</td>
<td>37</td>
<td><tt class="docutils literal"><span class="pre">(#,##0_);(#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0_);(#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0;-#,##0</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分、符号がなく間違っている。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>26</td>
<td>38</td>
<td><tt class="docutils literal"><span class="pre">(#,##0_);[Red](#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0_);[Red](#,##0)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0;[Red]-#,##0</span></tt></td>
<td><div class="first last line-block">
<div class="line">POI、JExcelAPIの場合、括弧が余分、符号がなく間違っている。</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>27</td>
<td>39</td>
<td><tt class="docutils literal"><span class="pre">(#,##0.00_);(#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00_);(#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00;-#,##0.00</span></tt></td>
<td>POI、JExcelAPIの場合、括弧が余分、符号がなく間違っている。</td>
</tr>
<tr class="row-even"><td>28</td>
<td>40</td>
<td><tt class="docutils literal"><span class="pre">(#,##0.00_);[Red](#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00_);[Red](#,##0.00)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">#,##0.00;[Red]-#,##0.00</span></tt></td>
<td>POI、JExcelAPIの場合、括弧が余分、符号がなく間違っている。</td>
</tr>
<tr class="row-odd"><td>29</td>
<td>41</td>
<td><tt class="docutils literal"><span class="pre">_(*#,##0_);_(*(#,##0);_(*\&quot;-\&quot;_);(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_(*</span> <span class="pre">#,##0_);_(*</span> <span class="pre">(#,##0);_(*</span> <span class="pre">\&quot;-\&quot;_);_(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_</span> <span class="pre">*</span> <span class="pre">#,##0_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">\\-#,##0_</span> <span class="pre">;_</span> <span class="pre">*</span> <span class="pre">\&quot;-\&quot;_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></tt></td>
<td>POI、JExcelAPIの場合、符号がなく間違っている。</td>
</tr>
<tr class="row-even"><td>2a</td>
<td>42</td>
<td><tt class="docutils literal"><span class="pre">_($*#,##0_);_($*(#,##0);_($*\&quot;-\&quot;_);(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_($*</span> <span class="pre">#,##0_);_($*</span> <span class="pre">(#,##0);_($*</span> <span class="pre">\&quot;-\&quot;_);_(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">#,##0_</span> <span class="pre">;_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">\\-#,##0_</span> <span class="pre">;_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">\&quot;-\&quot;_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span></tt></td>
<td>JExcelAPI、POIの場合、符号がなく、通貨記号が異なる。</td>
</tr>
<tr class="row-odd"><td>2b</td>
<td>43</td>
<td><tt class="docutils literal"><span class="pre">_(*</span> <span class="pre">#,##0.00_);_(*</span> <span class="pre">(#,##0.00);_(*</span> <span class="pre">\&quot;-\&quot;??_);(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_(*</span> <span class="pre">#,##0.00_);_(*</span> <span class="pre">(#,##0.00);_(*</span> <span class="pre">\&quot;-\&quot;??_);_(&#64;_)</span></tt></td>
<td><a href="#id4"><span class="problematic" id="id5">``</span></a>_ * #,##0.00_ ;_ * (#,##0.00);_ * &#8220;-&#8221;??_ ;_ &#64;_ ``</td>
<td>JExcelAPIの場合、文字列の書式が間違っている。</td>
</tr>
<tr class="row-even"><td>2c</td>
<td>44</td>
<td><tt class="docutils literal"><span class="pre">_($*</span> <span class="pre">#,##0.00_);_($*</span> <span class="pre">(#,##0.00);_($*</span> <span class="pre">\&quot;-\&quot;??_);(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_($*</span> <span class="pre">#,##0.00_);_($*</span> <span class="pre">(#,##0.00);_($*</span> <span class="pre">\&quot;-\&quot;??_);_(&#64;_)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">#,##0.00_</span> <span class="pre">;_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">-#,##0.00_</span> <span class="pre">;_</span> <span class="pre">\&quot;\\&quot;*</span> <span class="pre">\&quot;-\&quot;??_</span> <span class="pre">;_</span> <span class="pre">&#64;_</span> <span class="pre">&quot;</span></tt></td>
<td>JExcelAPI、POIの場合、通貨記号が異なる。</td>
</tr>
<tr class="row-odd"><td>2d</td>
<td>45</td>
<td><tt class="docutils literal"><span class="pre">mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mm:ss</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>2e</td>
<td>46</td>
<td><tt class="docutils literal"><span class="pre">[h]mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">[h]:mm:ss</span></tt></td>
<td><tt class="docutils literal"><span class="pre">[h]:mm:ss</span></tt></td>
<td>JExcelAPIの場合、コロン&#8221;:&#8221;が足りない。</td>
</tr>
<tr class="row-odd"><td>2f</td>
<td>47</td>
<td><tt class="docutils literal"><span class="pre">mm:ss.0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mm:ss.0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mm:ss.0</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>30</td>
<td>48</td>
<td><tt class="docutils literal"><span class="pre">##0.0E+0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">##0.0E+0</span></tt></td>
<td><tt class="docutils literal"><span class="pre">##0.0E+0</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>31</td>
<td>49</td>
<td><tt class="docutils literal"><span class="pre">&#64;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&#64;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&#64;</span></tt></td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<div class="section" id="jexcelapi">
<h3>4.2.1. JExcelAPIによる書式のインデックスの取得<a class="headerlink" href="#jexcelapi" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>JExcelAPIでは、書式のインデックスの取得は基本的には <em>DisplayFormat#getFormatIndex()</em> から取得します。</li>
<li>ビルトインフォーマットの定義は、非公開のクラス <em>jxl.biff.BuiltInfFomrat</em> で定義されています。</li>
<li>本ライブラリでは、 <em>JXLCell#getFormatIndex()</em> で実装されている。</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">final</span> <span class="n">CellFormat</span> <span class="n">cellStyle</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getCellFormat</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">cellStyle</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 書式を持たない場合</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="n">Format</span> <span class="n">cellFormat</span> <span class="o">=</span> <span class="n">cellStyle</span><span class="o">.</span><span class="na">getFormat</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">cellStyle</span> <span class="k">instanceof</span> <span class="n">XFRecord</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">XFRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="o">(</span><span class="n">XFRecord</span><span class="o">)</span> <span class="n">cellStyle</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="n">record</span><span class="o">.</span><span class="na">formatIndex</span><span class="o">;</span>

<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 書式を持たない場合</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="k">if</span><span class="o">(</span><span class="n">cellFormat</span> <span class="k">instanceof</span> <span class="n">DisplayFormat</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">DisplayFormat</span> <span class="n">displayFormat</span> <span class="o">=</span> <span class="o">(</span><span class="n">DisplayFormat</span><span class="o">)</span><span class="n">cellFormat</span><span class="o">;</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="n">displayFormat</span><span class="o">.</span><span class="na">getFormatIndex</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// 不明な場合</span>
<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="apache-poi">
<h3>4.2.2. Apache POIによる書式のインデックスの取得<a class="headerlink" href="#apache-poi" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>Apache POIの書式のインデックスは、 <em>CellSyle#getDataFormat()</em> から取得します。</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">short</span> <span class="kt">short</span> <span class="n">formatIndex</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="na">getCellStyle</span><span class="o">().</span><span class="na">getDataFormat</span><span class="o">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id-lcid">
<h2>4.3. ロケールID(LCID)の一覧<a class="headerlink" href="#id-lcid" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelで指定可能なロケールの一覧は、外部サイトの <a class="reference external" href="https://msdn.microsoft.com/ja-jp/library/cc392381.aspx">ロケール ID (LCID) の一覧</a> で確認できます。</p>
<p>Excelの書式で指定する際には、16進数表記の値で指定します。</p>
<p>日本語の場合、LCIDは0x0411であるため、書式上では <tt class="docutils literal"><span class="pre">[$-411]</span></tt> と指定します。</p>
<table border="1" class="docutils">
<caption>LCIDの一覧</caption>
<colgroup>
<col width="20%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="20%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ロケール名</th>
<th class="head">言語コード</th>
<th class="head">16進値</th>
<th class="head">10進数</th>
<th class="head">ロケール名</th>
<th class="head">言語コード</th>
<th class="head">16進値</th>
<th class="head">10進数</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>アフリカーンス語</td>
<td>af</td>
<td>0x0436</td>
<td>1078</td>
<td>ヒンズー語</td>
<td>hi</td>
<td>0x0439</td>
<td>1081</td>
</tr>
<tr class="row-odd"><td>アルバニア語</td>
<td>sq</td>
<td>0x041C</td>
<td>1052</td>
<td>ハンガリー語</td>
<td>hu</td>
<td>0x040E</td>
<td>1038</td>
</tr>
<tr class="row-even"><td>アラビア語 (U.A.E.)</td>
<td>ar-ae</td>
<td>0x3801</td>
<td>14337</td>
<td>アイスランド語</td>
<td>is</td>
<td>0x040F</td>
<td>1039</td>
</tr>
<tr class="row-odd"><td>アラビア語 (バーレーン)</td>
<td>ar-bh</td>
<td>0x3C01</td>
<td>15361</td>
<td>インドネシア語</td>
<td>in</td>
<td>0x0421</td>
<td>1057</td>
</tr>
<tr class="row-even"><td>アラビア語 (アルジェリア)</td>
<td>ar-dz</td>
<td>0x1401</td>
<td>5121</td>
<td>イタリア語 (イタリア)</td>
<td>it</td>
<td>0x0410</td>
<td>1040</td>
</tr>
<tr class="row-odd"><td>アラビア語 (エジプト)</td>
<td>ar-eg</td>
<td>0x0C01</td>
<td>3073</td>
<td>イタリア語 (スイス)</td>
<td>it-ch</td>
<td>0x0810</td>
<td>2064</td>
</tr>
<tr class="row-even"><td>アラビア語 (イラク)</td>
<td>ar-iq</td>
<td>0x0801</td>
<td>2049</td>
<td>日本語</td>
<td>ja</td>
<td>0x0411</td>
<td>1041</td>
</tr>
<tr class="row-odd"><td>アラビア語 (ヨルダン)</td>
<td>ar-jo</td>
<td>0x2C01</td>
<td>11265</td>
<td>韓国語</td>
<td>ko</td>
<td>0x0412</td>
<td>1042</td>
</tr>
<tr class="row-even"><td>アラビア語 (クウェート)</td>
<td>ar-kw</td>
<td>0x3401</td>
<td>13313</td>
<td>ラトビア語</td>
<td>lv</td>
<td>0x0426</td>
<td>1062</td>
</tr>
<tr class="row-odd"><td>アラビア語 (レバノン)</td>
<td>ar-lb</td>
<td>0x3001</td>
<td>12289</td>
<td>リトアニア語</td>
<td>lt</td>
<td>0x0427</td>
<td>1063</td>
</tr>
<tr class="row-even"><td>アラビア語 (リビア)</td>
<td>ar-ly</td>
<td>0x1001</td>
<td>4097</td>
<td>マケドニア語 (FYROM)</td>
<td>mk</td>
<td>0x042F</td>
<td>1071</td>
</tr>
<tr class="row-odd"><td>アラビア語 (モロッコ)</td>
<td>ar-ma</td>
<td>0x1801</td>
<td>6145</td>
<td>マレー語 (マレーシア)</td>
<td>ms</td>
<td>0x043E</td>
<td>1086</td>
</tr>
<tr class="row-even"><td>アラビア語 (オマーン)</td>
<td>ar-om</td>
<td>0x2001</td>
<td>8193</td>
<td>マルタ語</td>
<td>mt</td>
<td>0x043A</td>
<td>1082</td>
</tr>
<tr class="row-odd"><td>アラビア語 (カタール)</td>
<td>ar-qa</td>
<td>0x4001</td>
<td>16385</td>
<td>ノルウェー語 (ブークモール)</td>
<td>no</td>
<td>0x0414</td>
<td>1044</td>
</tr>
<tr class="row-even"><td>アラビア語 (サウジアラビア)</td>
<td>ar-sa</td>
<td>0x0401</td>
<td>1025</td>
<td>ポーランド語</td>
<td>pl</td>
<td>0x0415</td>
<td>1045</td>
</tr>
<tr class="row-odd"><td>アラビア語 (シリア)</td>
<td>ar-sy</td>
<td>0x2801</td>
<td>10241</td>
<td>ポルトガル語 (ポルトガル)</td>
<td>pt</td>
<td>0x0816</td>
<td>2070</td>
</tr>
<tr class="row-even"><td>アラビア語 (チュニジア)</td>
<td>ar-tn</td>
<td>0x1C01</td>
<td>7169</td>
<td>ポルトガル語 (ブラジル)</td>
<td>pt-br</td>
<td>0x0416</td>
<td>1046</td>
</tr>
<tr class="row-odd"><td>アラビア語 (イエメン)</td>
<td>ar-ye</td>
<td>0x2401</td>
<td>9217</td>
<td>レトロマン語</td>
<td>rm</td>
<td>0x0417</td>
<td>1047</td>
</tr>
<tr class="row-even"><td>バスク語</td>
<td>eu</td>
<td>0x042D</td>
<td>1069</td>
<td>ルーマニア語</td>
<td>ro</td>
<td>0x0418</td>
<td>1048</td>
</tr>
<tr class="row-odd"><td>ベラルーシ語</td>
<td>be</td>
<td>0x0423</td>
<td>1059</td>
<td>ルーマニア語 (モルドバ)</td>
<td>ro-mo</td>
<td>0x0818</td>
<td>2072</td>
</tr>
<tr class="row-even"><td>ブルガリア語</td>
<td>bg</td>
<td>0x0402</td>
<td>1026</td>
<td>ロシア語</td>
<td>ru</td>
<td>0x0419</td>
<td>1049</td>
</tr>
<tr class="row-odd"><td>カタロニア語</td>
<td>ca</td>
<td>0x0403</td>
<td>1027</td>
<td>ロシア語 (モルドバ)</td>
<td>ru-mo</td>
<td>0x0819</td>
<td>2073</td>
</tr>
<tr class="row-even"><td>中国語 (中華人民共和国)</td>
<td>zh-cn</td>
<td>0x0804</td>
<td>2052</td>
<td>セルビア語 (キリル文字)</td>
<td>sr</td>
<td>0x0C1A</td>
<td>3098</td>
</tr>
<tr class="row-odd"><td>中国語 (香港)</td>
<td>zh-hk</td>
<td>0x0C04</td>
<td>3076</td>
<td>ツワナ語</td>
<td>tn</td>
<td>0x0432</td>
<td>1074</td>
</tr>
<tr class="row-even"><td>中国語 (シンガポール)</td>
<td>zh-sg</td>
<td>0x1004</td>
<td>4100</td>
<td>スロベニア語</td>
<td>sl</td>
<td>0x0424</td>
<td>1060</td>
</tr>
<tr class="row-odd"><td>中国語 (台湾)</td>
<td>zh-tw</td>
<td>0x0404</td>
<td>1028</td>
<td>スロバキア語</td>
<td>sk</td>
<td>0x041B</td>
<td>1051</td>
</tr>
<tr class="row-even"><td>クロアチア語</td>
<td>hr</td>
<td>0x041A</td>
<td>1050</td>
<td>ソルビア語</td>
<td>sb</td>
<td>0x042E</td>
<td>1070</td>
</tr>
<tr class="row-odd"><td>チェコ語</td>
<td>cs</td>
<td>0x0405</td>
<td>1029</td>
<td>スペイン語 (スペイン)</td>
<td>es</td>
<td>0x040A</td>
<td>1034</td>
</tr>
<tr class="row-even"><td>デンマーク語</td>
<td>da</td>
<td>0x0406</td>
<td>1030</td>
<td>スペイン語 (アルゼンチン)</td>
<td>es-ar</td>
<td>0x2C0A</td>
<td>11274</td>
</tr>
<tr class="row-odd"><td>オランダ語</td>
<td>nl</td>
<td>0x0413</td>
<td>1043</td>
<td>スペイン語 (ボリビア)</td>
<td>es-bo</td>
<td>0x400A</td>
<td>16394</td>
</tr>
<tr class="row-even"><td>オランダ語 (ベルギー)</td>
<td>nl-be</td>
<td>0x0813</td>
<td>2067</td>
<td>スペイン語 (チリ)</td>
<td>es-cl</td>
<td>0x340A</td>
<td>13322</td>
</tr>
<tr class="row-odd"><td>英語 (オーストラリア)</td>
<td>en-au</td>
<td>0x0C09</td>
<td>3081</td>
<td>スペイン語 (コロンビア)</td>
<td>es-co</td>
<td>0x240A</td>
<td>9226</td>
</tr>
<tr class="row-even"><td>英語 (ベリーズ)</td>
<td>en-bz</td>
<td>0x2809</td>
<td>10249</td>
<td>スペイン語 (コスタリカ)</td>
<td>es-cr</td>
<td>0x140A</td>
<td>5130</td>
</tr>
<tr class="row-odd"><td>英語 (カナダ)</td>
<td>en-ca</td>
<td>0x1009</td>
<td>4105</td>
<td>スペイン語 (ドミニカ共和国)</td>
<td>es-do</td>
<td>0x1C0A</td>
<td>7178</td>
</tr>
<tr class="row-even"><td>英語 (アイルランド)</td>
<td>en-ie</td>
<td>0x1809</td>
<td>6153</td>
<td>スペイン語 (エクアドル)</td>
<td>es-ec</td>
<td>0x300A</td>
<td>12298</td>
</tr>
<tr class="row-odd"><td>英語 (ジャマイカ)</td>
<td>en-jm</td>
<td>0x2009</td>
<td>8201</td>
<td>スペイン語 (グアテマラ)</td>
<td>es-gt</td>
<td>0x100A</td>
<td>4106</td>
</tr>
<tr class="row-even"><td>英語 (ニュージーランド)</td>
<td>en-nz</td>
<td>0x1409</td>
<td>5129</td>
<td>スペイン語 (ホンジュラス)</td>
<td>es-hn</td>
<td>0x480A</td>
<td>18442</td>
</tr>
<tr class="row-odd"><td>英語 (南アフリカ)</td>
<td>en-za</td>
<td>0x1C09</td>
<td>7177</td>
<td>スペイン語 (メキシコ)</td>
<td>es-mx</td>
<td>0x080A</td>
<td>2058</td>
</tr>
<tr class="row-even"><td>英語 (トリニダード)</td>
<td>en-tt</td>
<td>0x2C09</td>
<td>11273</td>
<td>スペイン語 (ニカラグア)</td>
<td>es-ni</td>
<td>0x4C0A</td>
<td>19466</td>
</tr>
<tr class="row-odd"><td>英語 (U.K.)</td>
<td>en-gb</td>
<td>0x0809</td>
<td>2057</td>
<td>スペイン語 (パナマ)</td>
<td>es-pa</td>
<td>0x180A</td>
<td>6154</td>
</tr>
<tr class="row-even"><td>英語 (U.S.)</td>
<td>en-us</td>
<td>0x0409</td>
<td>1033</td>
<td>スペイン語 (ペルー)</td>
<td>es-pe</td>
<td>0x280A</td>
<td>10250</td>
</tr>
<tr class="row-odd"><td>エストニア語</td>
<td>et</td>
<td>0x0425</td>
<td>1061</td>
<td>スペイン語 (プエルトリコ)</td>
<td>es-pr</td>
<td>0x500A</td>
<td>20490</td>
</tr>
<tr class="row-even"><td>ペルシャ語</td>
<td>fa</td>
<td>0x0429</td>
<td>1065</td>
<td>スペイン語 (パラグアイ)</td>
<td>es-py</td>
<td>0x3C0A</td>
<td>15370</td>
</tr>
<tr class="row-odd"><td>フィンランド語</td>
<td>fi</td>
<td>0x040B</td>
<td>1035</td>
<td>スペイン語 (エルサルバドル)</td>
<td>es-sv</td>
<td>0x440A</td>
<td>17418</td>
</tr>
<tr class="row-even"><td>フェロー語</td>
<td>fo</td>
<td>0x0438</td>
<td>1080</td>
<td>スペイン語 (ウルグアイ)</td>
<td>es-uy</td>
<td>0x380A</td>
<td>14346</td>
</tr>
<tr class="row-odd"><td>フランス語 (フランス)</td>
<td>fr</td>
<td>0x040C</td>
<td>1036</td>
<td>スペイン語 (ベネズエラ)</td>
<td>es-ve</td>
<td>0x200A</td>
<td>8202</td>
</tr>
<tr class="row-even"><td>フランス語 (ベルギー)</td>
<td>fr-be</td>
<td>0x080C</td>
<td>2060</td>
<td>ソト語</td>
<td>sx</td>
<td>0x0430</td>
<td>1072</td>
</tr>
<tr class="row-odd"><td>フランス語 (カナダ)</td>
<td>fr-ca</td>
<td>0x0C0C</td>
<td>3084</td>
<td>スウェーデン語</td>
<td>sv</td>
<td>0x041D</td>
<td>1053</td>
</tr>
<tr class="row-even"><td>フランス語 (ルクセンブルグ)</td>
<td>fr-lu</td>
<td>0x140C</td>
<td>5132</td>
<td>スウェーデン語 (フィンランド)</td>
<td>sv-fi</td>
<td>0x081D</td>
<td>2077</td>
</tr>
<tr class="row-odd"><td>フランス語 (スイス)</td>
<td>fr-ch</td>
<td>0x100C</td>
<td>4108</td>
<td>タイ語</td>
<td>th</td>
<td>0x041E</td>
<td>1054</td>
</tr>
<tr class="row-even"><td>ゲール語 (スコットランド)</td>
<td>gd</td>
<td>0x043C</td>
<td>1084</td>
<td>トルコ語</td>
<td>tr</td>
<td>0x041F</td>
<td>1055</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (ドイツ)</td>
<td>de</td>
<td>0x0407</td>
<td>1031</td>
<td>ツォンガ語</td>
<td>ts</td>
<td>0x0431</td>
<td>1073</td>
</tr>
<tr class="row-even"><td>ドイツ語 (オーストリア)</td>
<td>de-at</td>
<td>0x0C07</td>
<td>3079</td>
<td>ウクライナ語</td>
<td>uk</td>
<td>0x0422</td>
<td>1058</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (リヒテンシュタイン)</td>
<td>de-li</td>
<td>0x1407</td>
<td>5127</td>
<td>ウルドゥー語 (パキスタン)</td>
<td>ur</td>
<td>0x0420</td>
<td>1056</td>
</tr>
<tr class="row-even"><td>ドイツ語 (ルクセンブルグ)</td>
<td>de-lu</td>
<td>0x1007</td>
<td>4103</td>
<td>ベトナム語</td>
<td>vi</td>
<td>0x042A</td>
<td>1066</td>
</tr>
<tr class="row-odd"><td>ドイツ語 (スイス)</td>
<td>de-ch</td>
<td>0x0807</td>
<td>2055</td>
<td>コーサ語</td>
<td>xh</td>
<td>0x0434</td>
<td>1076</td>
</tr>
<tr class="row-even"><td>ギリシャ語</td>
<td>el</td>
<td>0x0408</td>
<td>1032</td>
<td>イディッシュ語</td>
<td>ji</td>
<td>0x043D</td>
<td>1085</td>
</tr>
<tr class="row-odd"><td>ヘブライ語</td>
<td>he</td>
<td>0x040D</td>
<td>1037</td>
<td>ズールー語</td>
<td>zu</td>
<td>0x0435</td>
<td>1077</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h2>4.4. 漢数字／大字変換のロジック<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>漢数字や大字への変換は、下記のように行います。</p>
<ol class="arabic simple">
<li>下から4桁ごとに分割する。</li>
<li>分割した内容を漢数字に変換する。</li>
</ol>
<blockquote>
<div><ol class="loweralpha">
<li><p class="first">0の場合は省略する。</p>
</li>
<li><div class="first line-block">
<div class="line">1の場合は、桁数におおじて数値を省略し、単位のみを付与する。</div>
<div class="line">例えば、1の位の場合は数値を省略しない。</div>
<div class="line">十の位は、「十」と数値を省略して単位を付与する。</div>
</div>
</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>分割した変換結果に、4桁区切りの単位を付けて、結合する。</li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/convert_kansuji.png"><img alt="_images/convert_kansuji.png" src="_images/convert_kansuji.png" style="width: 929.6px; height: 492.8px;" /></a>
<p class="caption">漢数字の変換の概要</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="release.html" title="5. リリースノート"
             >次へ</a> |</li>
        <li class="right" >
          <a href="format_basic.html" title="3. Excelの書式の基本について"
             >前へ</a> |</li>
        <li><a href="index.html">Excel-CellFormatter 0.2 ドキュメント</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, T.TSUCHIE.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3 で生成しました。
    </div>
  </body>
</html>